Function E_REIHE(WERT As Double, REIHE As Integer, LOWER_HIGHER_NEAREST as String)

Dim E_WERTE(192) As Double
IF REIHE = 3 Then
E_WERTE(0) = 1.0
E_WERTE(1) = 2.2
E_WERTE(2) = 4.7
E_WERTE(3) = 10
ELSEIF REIHE = 6 Then
E_WERTE(0) = 1.0
E_WERTE(1) = 1.5
E_WERTE(2) = 2.2
E_WERTE(3) = 3.3
E_WERTE(4) = 4.7
E_WERTE(5) = 6.8
E_WERTE(6) = 10
ELSEIF REIHE = 12 Then
E_WERTE(0) = 1
E_WERTE(1) = 1.2
E_WERTE(2) = 1.5
E_WERTE(3) = 1.8
E_WERTE(4) = 2.2
E_WERTE(5) = 2.7
E_WERTE(6) = 3.3
E_WERTE(7) = 3.9
E_WERTE(8) = 4.7
E_WERTE(9) = 5.6
E_WERTE(10) = 6.8
E_WERTE(11) = 8.2
E_WERTE(12) = 10
ELSEIF REIHE = 24 Then
E_WERTE(0) = 1
E_WERTE(1) = 1.1
E_WERTE(2) = 1.2
E_WERTE(3) = 1.3
E_WERTE(4) = 1.5
E_WERTE(5) = 1.6
E_WERTE(6) = 1.8
E_WERTE(7) = 2#
E_WERTE(8) = 2.2
E_WERTE(9) = 2.4
E_WERTE(10) = 2.7
E_WERTE(11) = 3#
E_WERTE(12) = 3.3
E_WERTE(13) = 3.6
E_WERTE(14) = 3.9
E_WERTE(15) = 4.3
E_WERTE(16) = 4.7
E_WERTE(17) = 5.1
E_WERTE(18) = 5.6
E_WERTE(19) = 6.2
E_WERTE(20) = 6.8
E_WERTE(21) = 7.5
E_WERTE(22) = 8.2
E_WERTE(23) = 9.1
E_WERTE(24) = 10
ElseIf REIHE = 48 Then
E_WERTE(0) = 1
E_WERTE(1) = 1.05
E_WERTE(2) = 1.1
E_WERTE(3) = 1.15
E_WERTE(4) = 1.21
E_WERTE(5) = 1.27
E_WERTE(6) = 1.33
E_WERTE(7) = 1.4
E_WERTE(8) = 1.47
E_WERTE(9) = 1.54
E_WERTE(10) = 1.62
E_WERTE(11) = 1.69
E_WERTE(12) = 1.78
E_WERTE(13) = 1.87
E_WERTE(14) = 1.96
E_WERTE(15) = 2.05
E_WERTE(16) = 2.15
E_WERTE(17) = 2.26
E_WERTE(18) = 2.37
E_WERTE(19) = 2.49
E_WERTE(20) = 2.61
E_WERTE(21) = 2.74
E_WERTE(22) = 2.87
E_WERTE(23) = 3.01
E_WERTE(24) = 3.16
E_WERTE(25) = 3.32
E_WERTE(26) = 3.48
E_WERTE(27) = 3.65
E_WERTE(28) = 3.83
E_WERTE(29) = 4.02
E_WERTE(30) = 4.22
E_WERTE(31) = 4.42
E_WERTE(32) = 4.64
E_WERTE(33) = 4.87
E_WERTE(34) = 5.11
E_WERTE(35) = 5.36
E_WERTE(36) = 5.62
E_WERTE(37) = 5.9
E_WERTE(38) = 6.19
E_WERTE(39) = 6.49
E_WERTE(40) = 6.81
E_WERTE(41) = 7.15
E_WERTE(42) = 7.5
E_WERTE(43) = 7.87
E_WERTE(44) = 8.25
E_WERTE(45) = 8.66
E_WERTE(46) = 9.09
E_WERTE(47) = 9.53
E_WERTE(48) = 9.53
ElseIf REIHE = 96 Then
E_WERTE(0) = 1
E_WERTE(1) = 1.02
E_WERTE(2) = 1.05
E_WERTE(3) = 1.07
E_WERTE(4) = 1.1
E_WERTE(5) = 1.13
E_WERTE(6) = 1.15
E_WERTE(7) = 1.18
E_WERTE(8) = 1.21
E_WERTE(9) = 1.24
E_WERTE(10) = 1.27
E_WERTE(11) = 1.3
E_WERTE(12) = 1.33
E_WERTE(13) = 1.37
E_WERTE(14) = 1.4
E_WERTE(15) = 1.43
E_WERTE(16) = 1.47
E_WERTE(17) = 1.5
E_WERTE(18) = 1.54
E_WERTE(19) = 1.58
E_WERTE(20) = 1.62
E_WERTE(21) = 1.65
E_WERTE(22) = 1.69
E_WERTE(23) = 1.74
E_WERTE(24) = 1.78
E_WERTE(25) = 1.82
E_WERTE(26) = 1.87
E_WERTE(27) = 1.91
E_WERTE(28) = 1.96
E_WERTE(29) = 2#
E_WERTE(30) = 2.05
E_WERTE(31) = 2.1
E_WERTE(32) = 2.15
E_WERTE(33) = 2.21
E_WERTE(34) = 2.26
E_WERTE(35) = 2.32
E_WERTE(36) = 2.37
E_WERTE(37) = 2.43
E_WERTE(38) = 2.49
E_WERTE(39) = 2.55
E_WERTE(40) = 2.61
E_WERTE(41) = 2.67
E_WERTE(42) = 2.74
E_WERTE(43) = 2.8
E_WERTE(44) = 2.87
E_WERTE(45) = 2.94
E_WERTE(46) = 3.01
E_WERTE(47) = 3.09
E_WERTE(48) = 3.16
E_WERTE(49) = 3.24
E_WERTE(50) = 3.32
E_WERTE(51) = 3.4
E_WERTE(52) = 3.48
E_WERTE(53) = 3.57
E_WERTE(54) = 3.65
E_WERTE(55) = 3.74
E_WERTE(56) = 3.83
E_WERTE(57) = 3.92
E_WERTE(58) = 4.02
E_WERTE(59) = 4.12
E_WERTE(60) = 4.22
E_WERTE(61) = 4.32
E_WERTE(62) = 4.42
E_WERTE(63) = 4.53
E_WERTE(64) = 4.64
E_WERTE(65) = 4.75
E_WERTE(66) = 4.87
E_WERTE(67) = 4.99
E_WERTE(68) = 5.11
E_WERTE(69) = 5.23
E_WERTE(70) = 5.36
E_WERTE(71) = 5.49
E_WERTE(72) = 5.62
E_WERTE(73) = 5.76
E_WERTE(74) = 5.9
E_WERTE(75) = 6.04
E_WERTE(76) = 6.19
E_WERTE(77) = 6.34
E_WERTE(78) = 6.49
E_WERTE(79) = 6.65
E_WERTE(80) = 6.81
E_WERTE(81) = 6.98
E_WERTE(82) = 7.15
E_WERTE(83) = 7.32
E_WERTE(84) = 7.5
E_WERTE(85) = 7.68
E_WERTE(86) = 7.87
E_WERTE(87) = 8.06
E_WERTE(88) = 8.25
E_WERTE(89) = 8.45
E_WERTE(90) = 8.66
E_WERTE(91) = 8.87
E_WERTE(92) = 9.09
E_WERTE(93) = 9.31
E_WERTE(94) = 9.53
E_WERTE(95) = 9.76
E_WERTE(96) = 9.76
ElseIf REIHE = 192 Then
E_WERTE(0) = 1
E_WERTE(1) = 1.01
E_WERTE(2) = 1.02
E_WERTE(3) = 1.04
E_WERTE(4) = 1.05
E_WERTE(5) = 1.06
E_WERTE(6) = 1.07
E_WERTE(7) = 1.09
E_WERTE(8) = 1.1
E_WERTE(9) = 1.11
E_WERTE(10) = 1.13
E_WERTE(11) = 1.14
E_WERTE(12) = 1.15
E_WERTE(13) = 1.17
E_WERTE(14) = 1.18
E_WERTE(15) = 1.2
E_WERTE(16) = 1.21
E_WERTE(17) = 1.23
E_WERTE(18) = 1.24
E_WERTE(19) = 1.26
E_WERTE(20) = 1.27
E_WERTE(21) = 1.29
E_WERTE(22) = 1.3
E_WERTE(23) = 1.32
E_WERTE(24) = 1.33
E_WERTE(25) = 1.35
E_WERTE(26) = 1.37
E_WERTE(27) = 1.38
E_WERTE(28) = 1.4
E_WERTE(29) = 1.42
E_WERTE(30) = 1.43
E_WERTE(31) = 1.45
E_WERTE(32) = 1.47
E_WERTE(33) = 1.49
E_WERTE(34) = 1.5
E_WERTE(35) = 1.52
E_WERTE(36) = 1.54
E_WERTE(37) = 1.56
E_WERTE(38) = 1.58
E_WERTE(39) = 1.6
E_WERTE(40) = 1.62
E_WERTE(41) = 1.64
E_WERTE(42) = 1.65
E_WERTE(43) = 1.67
E_WERTE(44) = 1.69
E_WERTE(45) = 1.72
E_WERTE(46) = 1.74
E_WERTE(47) = 1.76
E_WERTE(48) = 1.78
E_WERTE(49) = 1.8
E_WERTE(50) = 1.82
E_WERTE(51) = 1.84
E_WERTE(52) = 1.87
E_WERTE(53) = 1.89
E_WERTE(54) = 1.91
E_WERTE(55) = 1.93
E_WERTE(56) = 1.96
E_WERTE(57) = 1.98
E_WERTE(58) = 2#
E_WERTE(59) = 2.03
E_WERTE(60) = 2.05
E_WERTE(61) = 2.08
E_WERTE(62) = 2.1
E_WERTE(63) = 2.13
E_WERTE(64) = 2.15
E_WERTE(65) = 2.18
E_WERTE(66) = 2.21
E_WERTE(67) = 2.23
E_WERTE(68) = 2.26
E_WERTE(69) = 2.29
E_WERTE(70) = 2.32
E_WERTE(71) = 2.34
E_WERTE(72) = 2.37
E_WERTE(73) = 2.4
E_WERTE(74) = 2.43
E_WERTE(75) = 2.46
E_WERTE(76) = 2.49
E_WERTE(77) = 2.52
E_WERTE(78) = 2.55
E_WERTE(79) = 2.58
E_WERTE(80) = 2.61
E_WERTE(81) = 2.64
E_WERTE(82) = 2.67
E_WERTE(83) = 2.71
E_WERTE(84) = 2.74
E_WERTE(85) = 2.77
E_WERTE(86) = 2.8
E_WERTE(87) = 2.84
E_WERTE(88) = 2.87
E_WERTE(89) = 2.91
E_WERTE(90) = 2.94
E_WERTE(91) = 2.98
E_WERTE(92) = 3.01
E_WERTE(93) = 3.05
E_WERTE(94) = 3.09
E_WERTE(95) = 3.12
E_WERTE(96) = 3.16
E_WERTE(97) = 3.2
E_WERTE(98) = 3.24
E_WERTE(99) = 3.26
E_WERTE(100) = 3.32
E_WERTE(101) = 3.36
E_WERTE(102) = 3.4
E_WERTE(103) = 3.44
E_WERTE(104) = 3.48
E_WERTE(105) = 3.52
E_WERTE(106) = 3.57
E_WERTE(107) = 3.61
E_WERTE(108) = 3.65
E_WERTE(109) = 3.7
E_WERTE(110) = 3.74
E_WERTE(111) = 3.79
E_WERTE(112) = 3.83
E_WERTE(113) = 3.88
E_WERTE(114) = 3.92
E_WERTE(115) = 3.97
E_WERTE(116) = 4.02
E_WERTE(117) = 4.07
E_WERTE(118) = 4.12
E_WERTE(119) = 4.17
E_WERTE(120) = 4.22
E_WERTE(121) = 4.27
E_WERTE(122) = 4.32
E_WERTE(123) = 4.37
E_WERTE(124) = 4.42
E_WERTE(125) = 4.48
E_WERTE(126) = 4.53
E_WERTE(127) = 4.59
E_WERTE(128) = 4.64
E_WERTE(129) = 4.7
E_WERTE(130) = 4.75
E_WERTE(131) = 4.81
E_WERTE(132) = 4.87
E_WERTE(133) = 4.93
E_WERTE(134) = 4.99
E_WERTE(135) = 5.05
E_WERTE(136) = 5.11
E_WERTE(137) = 5.17
E_WERTE(138) = 5.23
E_WERTE(139) = 5.3
E_WERTE(140) = 5.36
E_WERTE(141) = 5.42
E_WERTE(142) = 5.49
E_WERTE(143) = 5.56
E_WERTE(144) = 5.62
E_WERTE(145) = 5.69
E_WERTE(146) = 5.76
E_WERTE(147) = 5.83
E_WERTE(148) = 5.9
E_WERTE(149) = 5.97
E_WERTE(150) = 6.04
E_WERTE(151) = 6.12
E_WERTE(152) = 6.19
E_WERTE(153) = 6.26
E_WERTE(154) = 6.34
E_WERTE(155) = 6.42
E_WERTE(156) = 6.49
E_WERTE(157) = 6.57
E_WERTE(158) = 6.65
E_WERTE(159) = 6.73
E_WERTE(160) = 6.81
E_WERTE(161) = 6.9
E_WERTE(162) = 6.99
E_WERTE(163) = 7.06
E_WERTE(164) = 7.15
E_WERTE(165) = 7.23
E_WERTE(166) = 7.32
E_WERTE(167) = 7.41
E_WERTE(168) = 7.5
E_WERTE(169) = 7.59
E_WERTE(170) = 7.68
E_WERTE(171) = 7.77
E_WERTE(172) = 7.87
E_WERTE(173) = 7.96
E_WERTE(174) = 8.06
E_WERTE(175) = 8.16
E_WERTE(176) = 8.25
E_WERTE(177) = 8.35
E_WERTE(178) = 8.45
E_WERTE(179) = 8.56
E_WERTE(180) = 8.66
E_WERTE(181) = 8.76
E_WERTE(182) = 8.87
E_WERTE(183) = 8.98
E_WERTE(184) = 9.09
E_WERTE(185) = 9.2
E_WERTE(186) = 9.31
E_WERTE(187) = 9.42
E_WERTE(188) = 9.53
E_WERTE(189) = 9.65
E_WERTE(190) = 9.76
E_WERTE(191) = 9.88
E_WERTE(192) = 10
END IF

Dim operation As Double
operation = 1

IF Wert < 1 Then
Do
Wert = Wert * 10
operation = operation / 10
Loop While Wert <= 1
End If

IF Wert > 10 Then
Do
Wert = Wert / 10
operation = operation * 10
Loop While Wert > 10
End If

Dim Ergebnisse(3) As Double
FOR i = 0 TO REIHE
IF E_WERTE(i) >= Wert Then
Ergebnisse(1) = E_WERTE(i)
Ergebnisse(2) = E_WERTE(i-1)
EXIT FOR
End If
Next i
IF ABS(Ergebnisse(1)-Wert) < ABS(Ergebnisse(2)-Wert) Then
Ergebnisse(3) = Ergebnisse(1)
ELSE
Ergebnisse(3) = Ergebnisse(2)
END IF

If LOWER_HIGHER_NEAREST = "LOWER" THEN
E_REIHE = Ergebnisse(1) * operation
ELSEIF LOWER_HIGHER_NEAREST = "HIGHER" THEN
E_REIHE = Ergebnisse(2) * operation
ELSE
E_REIHE = Ergebnisse(3) * operation
END IF
End Function
